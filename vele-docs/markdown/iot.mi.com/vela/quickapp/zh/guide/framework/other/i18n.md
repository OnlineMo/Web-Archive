::: {#app server-rendered="true"}
::: theme-container
::: navbar
::: sidebar-button
![](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtaGlkZGVuPSJ0cnVlIiByb2xlPSJpbWciIHZpZXdib3g9IjAgMCA0NDggNTEyIiBjbGFzcz0iaWNvbiI+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJNNDM2IDEyNEgxMmMtNi42MjcgMC0xMi01LjM3My0xMi0xMlY4MGMwLTYuNjI3IDUuMzczLTEyIDEyLTEyaDQyNGM2LjYyNyAwIDEyIDUuMzczIDEyIDEydjMyYzAgNi42MjctNS4zNzMgMTItMTIgMTJ6bTAgMTYwSDEyYy02LjYyNyAwLTEyLTUuMzczLTEyLTEydi0zMmMwLTYuNjI3IDUuMzczLTEyIDEyLTEyaDQyNGM2LjYyNyAwIDEyIDUuMzczIDEyIDEydjMyYzAgNi42MjctNS4zNzMgMTItMTIgMTJ6bTAgMTYwSDEyYy02LjYyNyAwLTEyLTUuMzczLTEyLTEydi0zMmMwLTYuNjI3IDUuMzczLTEyIDEyLTEyaDQyNGM2LjYyNyAwIDEyIDUuMzczIDEyIDEydjMyYzAgNi42MjctNS4zNzMgMTItMTIgMTJ6Ij48L3BhdGg+PC9zdmc+){.icon}
:::

[![Xiaomi Vela JS 应用](../../../../logo.png){.logo} [Xiaomi Vela JS
应用]{.site-name
.can-hide}](https://iot.mi.com/vela/quickapp/){.home-link
.router-link-active}

::: links
::: search-box
:::

::: nav-item
[教程](../../version/APILevel4.html){.nav-link .router-link-active}
:::

::: nav-item
[组件](../../../components/index.html){.nav-link}
:::

::: nav-item
[JS接口](../../../features/index.html){.nav-link}
:::

::: nav-item
[编程示例](../../../samples/index.html){.nav-link}
:::

::: nav-item
[工具](../../../tools/index.html){.nav-link}
:::

::: nav-item
::: dropdown-wrapper
[选择语言]{.title} []{.arrow .down}

[选择语言]{.title} []{.arrow .right}

-   [简体中文](i18n.html){.nav-link .router-link-exact-active
    .router-link-active aria-current="page"}
-   [English](https://iot.mi.com/vela/quickapp/en/guide/framework/other/i18n.html){.nav-link}
:::
:::
:::
:::

::: sidebar-mask
:::

::: nav-item
[教程](../../version/APILevel4.html){.nav-link .router-link-active}
:::

::: nav-item
[组件](../../../components/index.html){.nav-link}
:::

::: nav-item
[JS接口](../../../features/index.html){.nav-link}
:::

::: nav-item
[编程示例](../../../samples/index.html){.nav-link}
:::

::: nav-item
[工具](../../../tools/index.html){.nav-link}
:::

::: nav-item
::: dropdown-wrapper
[选择语言]{.title} []{.arrow .down}

[选择语言]{.title} []{.arrow .right}

-   [简体中文](i18n.html){.nav-link .router-link-exact-active
    .router-link-active aria-current="page"}
-   [English](https://iot.mi.com/vela/quickapp/en/guide/framework/other/i18n.html){.nav-link}
:::
:::

-   ::: {.section .sidebar-group .depth-0}
    [快速入门](https://iot.mi.com/vela/quickapp/zh/guide/start){.sidebar-heading
    .clickable}
    -   [安装环境](../../start/use-ide.html){.sidebar-link}
    -   [项目结构](../../start/project-overview.html){.sidebar-link}
    -   [编写页面UI](../../start/user-interface.html){.sidebar-link}
    -   [添加交互](../../start/add-interactivity.html){.sidebar-link}
    -   [数据获取](../../start/data-fetch.html){.sidebar-link}
    -   [编译参数](../../start/toolkit-params.html){.sidebar-link}
    :::

-   ::: {.section .sidebar-group .depth-0}
    [基础功能](../index.html){.sidebar-heading .clickable
    .router-link-active}
    -   [项目结构](../project-structure.html){.sidebar-link}

    -   [项目配置](../manifest.html){.sidebar-link}

    -   [UX 文件](../ux.html){.sidebar-link}

    -   ::: {.section .sidebar-group .collapsable .is-sub-group .depth-1}
        [模板语法 []{.arrow
        .right}](../template/index.html){.sidebar-heading .clickable}
        :::

    -   ::: {.section .sidebar-group .collapsable .is-sub-group .depth-1}
        [样式语法 []{.arrow
        .right}](../style/index.html){.sidebar-heading .clickable}
        :::

    -   ::: {.section .sidebar-group .collapsable .is-sub-group .depth-1}
        [脚本语法 []{.arrow
        .right}](../script/index.html){.sidebar-heading .clickable}
        :::

    -   [页面切换](../page-switch.html){.sidebar-link}
    :::

-   ::: {.section .sidebar-group .depth-0}
    [进阶功能](index.html){.sidebar-heading .clickable
    .router-link-active .open}
    -   [多语言覆盖](i18n.html){.active .sidebar-link
        aria-current="page"}

    -   [后台运行](background-running.html){.sidebar-link}

    -   [hap 链接](hap-schema.html){.sidebar-link}

    -   [页面启动模式](launch-mode.html){.sidebar-link}

    -   ::: {.section .sidebar-group .collapsable .is-sub-group .depth-1}
        [多屏适配 []{.arrow
        .right}](../../multi-screens/index.html){.sidebar-heading
        .clickable}
        :::

    -   [动态组件](dynamic-component.html){.sidebar-link}
    :::

-   ::: {.section .sidebar-group .depth-0}
    [开发者物料](../../developer-materials/index.html){.sidebar-heading
    .clickable}
    -   [拓展组件](../../developer-materials/extension-components.html){.sidebar-link}
    :::

-   ::: {.section .sidebar-group .depth-0}
    [设计指南](../../design/index.html){.sidebar-heading .clickable}
    -   [多屏设计](../../design/multi-screens.html){.sidebar-link}
    :::

-   ::: {.section .sidebar-group .depth-0}
    [最佳实践](../../best-practice/index.html){.sidebar-heading
    .clickable}
    -   [内存优化](../../best-practice/memory.html){.sidebar-link}
    -   [常用业务优化](../../best-practice/business.html){.sidebar-link}
    -   [启动时延优化](../../best-practice/start.html){.sidebar-link}
    :::

-   ::: {.section .sidebar-group .depth-0}
    [发布](../../publish/index.html){.sidebar-heading .clickable}
    -   [验收标准](../../publish/acceptance-criteria.html){.sidebar-link}
    :::

-   ::: {.section .sidebar-group .depth-0}
    [版本说明](../../version/index.html){.sidebar-heading .clickable}
    -   [APILevel2](https://iot.mi.com/vela/quickapp/zh/guide/version/APILevel2.html){.sidebar-link}
    -   [APILevel3](https://iot.mi.com/vela/quickapp/zh/guide/version/APILevel3.html){.sidebar-link}
    -   [APILevel4](https://iot.mi.com/vela/quickapp/zh/guide/version/APILevel4.html){.sidebar-link}
    :::

-   ::: {.section .sidebar-group .depth-0}
    其他

    -   [常见问题](../../other/faq.html){.sidebar-link}
    -   [注意事项](../../other/tips.html){.sidebar-link}
    :::

::: {.page role="main"}
::: {.theme-default-content .content__default}
# [\#](i18n.html#多语言覆盖){.header-anchor} 多语言覆盖

Vela 的能力会覆盖多个国家地区，框架支持多语言的能力后，可以做到让一个JS
应用产品（一个 RPK
文件）同时支持多个语言版本的切换，开发者无需开发多个不同语言的源码项目，避免给项目维护带来困难。

使用系统默认的语言，开发者配置多语言的方式非常简单，只需要`定义资源`与`引用资源`两个步骤即可。

## [\#](i18n.html#定义资源文件){.header-anchor} 定义资源文件

资源文件用于存放多个语言的业务信息定义，与其它技术平台类似（它们使用`properties文件`或者`xml文件`的格式），JS
应用平台使用`JSON文件`保存资源定义；

在项目源码`src目录`下定义`i18n文件夹`，内部放置每个语言地区下的资源定义文件即可。

### [\#](i18n.html#资源文件命名查找规则及建议){.header-anchor} 资源文件命名查找规则及建议

文件命名可使用当前系统获取到的语言以及国家信息，例如文件名可定义为：`zh-CN.json`、`zh.json`。

如果开发者当前产品仅计划支持一种语言，同时还希望用到多语言能力，那么仅声明一个名称为`defaults.json`的文件即可。

JSON文件名匹配优先级，优先级高的匹配到就停止查找，否则就向下一级查找。

**优先级匹配规则**如下：

`<语言代码>-<国家代码>`

`<语言代码>`

`defaults`

默认i18n配置文件首个

**命名建议**：

-   如果需要精确匹配语言+地区进行多语言配置建议使用`<语言代码>-<国家代码>.json`命名资源文件；

-   不需要匹配地区的建议使用`<语言代码>.json`命名资源文件；

-   `defaults.json`可以作为默认选项单独使用，也可配合以上两种方式结合使用；

-   不推荐使用系统最终的兜底默认首个的方案，可能会造成不符合预期的显示结果。

::: {.custom-block .tip}
温馨提示

`<语言代码>-<国家代码>` 可参考：[支持的语言列表](language-list.html)。
:::

### [\#](i18n.html#资源文件支持的配置语法){.header-anchor} 资源文件支持的配置语法

#### [\#](i18n.html#基础文本配置){.header-anchor} 基础文本配置

::: {.language-json .extra-class}
``` language-json
{
  "message": {
    "hello": "hello world"
  }
}
```
:::

#### [\#](i18n.html#数组配置){.header-anchor} 数组配置

匹配到会把数据内容序列化转成文本输出，此种配置不支持与插值语法混用。

::: {.language-json .extra-class}
``` language-json
{
  "message": {
    "array": ["a", 2, {"c": 3}]
  }
}
```
:::

#### [\#](i18n.html#命名插值配置){.header-anchor} 命名插值配置

支持使用`{}`占位符进行命名插值，调用时通过具名参数传入替代占位内容。

::: {.language-json .extra-class}
``` language-json
{
  "message": {
    "hello": "{msg} world"
  }
}
```
:::

#### [\#](i18n.html#列表插值配置){.header-anchor} 列表插值配置

支持使用`{}`占位符进行列表插值，通过配置列表取值索引，在调用时传入备选列表进行取值替代占位内容。

::: {.language-json .extra-class}
``` language-json
{
  "message": {
    "hello": "{0} world"
  }
}
```
:::

#### [\#](i18n.html#单复数语法配置){.header-anchor} 单复数语法配置

支持使用`|`占位符进行单复数语法配置，不同的选择项使用占位符分隔。

::: {.language-json .extra-class}
``` language-json
{
  "message": {
    car: 'car | cars',
  }
}
```
:::

## [\#](i18n.html#页面中引用资源){.header-anchor} 页面中引用资源

使用多语言配置的方式主要通过ViewModel
实例上`$t`与`$tc`函数实现，这些方法可以在`<template>`或`<script>`中使用。

### [\#](i18n.html#简单格式化方法){.header-anchor} 简单格式化方法

this.\$t(path, opts)

**参数说明**：

  ---------------------------------------------------------------------------------------------------------------------------
  参数              类型              是否必填          说明
  ----------------- ----------------- ----------------- ---------------------------------------------------------------------
  path              String            是                获取多语言配置的资源路径，对象取值通过.连接，例如："message.hello"

  opts              Array \| Object   否                进行插值替换的配置项，可以传入对象或数组，配合配置中的差值配置使用\
                                                        若传入对象则需要指定配置的命名key进行传参\
                                                        若传入数组取值为传入列表对应的列表插值配置的index值
  ---------------------------------------------------------------------------------------------------------------------------

**使用示例**：

使用**基础文本配置**对应取值示例：

::: {.language-html .extra-class}
``` language-html
<template>
  <div>
    <!-- 显示结果 hello world -->
    <text>{{ $t('message.hello') }}</text>
  </div>
</template>

<script>
  export default {
    onInit () {
      // 简单格式化：
      console.log(this.$t('message.hello')) // hello world
    }
  }
</script>
```
:::

使用**数组配置**对应取值示例：

::: {.language-html .extra-class}
``` language-html
<template>
  <div>
    <!-- 直接显示数组，显示结果 ["a", 2, {"c": 3}] -->
    <text>{{ $t('message.array') }}</text>
  </div>
</template>

<script>
  export default {
    onInit () {
      // 简单格式化：
      console.log(this.$t('message.array')) // ["a", 2, {"c": 3}]
    }
  }
</script>
```
:::

使用**命名插值配置**对应取值示例：

::: {.language-html .extra-class}
``` language-html
<template>
  <div>
    <!-- 显示结果 hello world -->
    <text>{{ $t('message.hello', { msg: 'hello' }) }}</text>
  </div>
</template>

<script>
  export default {
    onInit () {
      // 简单格式化：
      console.log(this.$t('message.hello', { msg: 'hello' }))  // hello world
    }
  }
</script>
```
:::

使用**列表插值配置**对应取值示例：

::: {.language-html .extra-class}
``` language-html
<template>
  <div>
    <!-- 显示结果 hello world -->
    <text>{{ $t('message.hello', ['hello', 'hi']) }}</text>
  </div>
</template>

<script>
  export default {
    onInit () {
      // 简单格式化：
      console.log(this.$t('message.hello', ['hello', 'hi'])) // hello world
    }
  }
</script>
```
:::

### [\#](i18n.html#单复数格式化方法){.header-anchor} 单复数格式化方法

this.\$tc(path, choice, opts)

**参数说明**：

  ---------------------------------------------------------------------------------------------------------------------------
  参数              类型              是否必填          说明
  ----------------- ----------------- ----------------- ---------------------------------------------------------------------
  path              String            是                获取多语言配置的资源路径，对象取值通过.连接，例如："message.hello"

  choice            Number            否                用于判断使用第几个选项的值，在不传入第三个参数时也可用作插值显示\
                                                        **特殊值说明**：\
                                                        值必须是整数，错参报错不显示返回空字符串\
                                                        单复数判断忽略正负符号\
                                                        0作为偶数处理

  opts              Array \| Object   否                进行插值替换的配置项，可以传入对象或数组，配合配置中的差值配置使用\
                                                        若传入对象则需要指定配置的命名key进行传参\
                                                        若传入数组取值为传入列表对应的列表插值配置的index值
  ---------------------------------------------------------------------------------------------------------------------------

**单复数配置说明**：

目前单复数在资源文件中支持两种写法并支持与插值语法混用。

两段式配置：单数\|复数；

三段式配置：空值\|单数\|复数。

**配置示例**：

::: {.language-json .extra-class}
``` language-json
{
  "message": {
    car: 'car | cars', // 两段式配置
    apple: 'no apples | one apple | {count} apples' // 三段式配置
  }
}
```
:::

**使用示例**：

::: {.language-html .extra-class}
``` language-html
<template>
  <div>
    <!-- 两段单复数 -->
    <!-- 显示结果 cars -->
    <text>{{ $tc('message.car', 0) }}</text>
    <!-- 显示结果 car -->
    <text>{{ $tc('message.car', 1) }}</text>
    <!-- 显示结果 cars -->
    <text>{{ $tc('message.car', 2) }}</text>

    <!-- 三段单复数 -->
    <!-- 显示结果 no apples -->
    <text>{{ $tc('message.apple', 0) }}</text>
    <!-- 显示结果 one apple -->
    <text>{{ $tc('message.apple', 1) }}</text>
    <!-- 显示结果 2 apples -->
    <text>{{ $tc('message.apple', 2) }}</text>
    <!-- 三段单复数混合插值使用 -->
    <!-- 显示结果 6 apples -->
    <text>{{ $tc('message.apple', 2, {count: 6}) }}</text>
  </div>
</template>

<script>
  export default {
    onInit () {
      // 两段单复数：
      console.log(this.$tc('message.car', 0)) // cars
      console.log(this.$tc('message.car', 1)) // car
      console.log(this.$tc('message.car', 2)) // cars

      // 三段单复数：
      console.log(this.$tc('message.apple', 0)) // no apples
      console.log(this.$tc('message.apple', 1)) // one apple
      console.log(this.$tc('message.apple', 2)) // 2 apples
      console.log(this.$tc('message.apple', 2, {count: 6})) // 6 apples
    }
  }
</script>
```
:::

## [\#](i18n.html#获取系统语言){.header-anchor} 获取系统语言

上面的能力用于资源内容的格式化，在某些场景下开发者可能需要获取当前系统的地区语言`locale`并进行更改，来完成不同的逻辑处理。比如：

-   不同的 locale 对应的页面布局不同；

-   开发者为用户提供设置某种语言的能力；

框架`system.configuration`提供了相关功能，文档参考：[应用配置
configuration](../../../features/basic/configuration.html)。

## [\#](i18n.html#修改地区语言后的回调){.header-anchor} 修改地区语言后的回调

当用户在系统设置切换地区语言，会触发 onConfigurationChanged
回调，且返回来的 event.type 值为locale。

详情可参考[文档](../script/lifecycle.html#onconfigurationchangedevent)。

示例代码：

::: {.language-javascript .extra-class}
``` language-javascript
// 监听语言变化
onConfigurationChanged(event) {
  if (event && event.type && event.type === 'locale') {
    console.log('locale or language changed!')
  }
}
```
:::
:::

::: page-nav
[ ← [页面切换](../page-switch.html){.prev} ]{.prev} [
[后台运行](background-running.html) → ]{.next}
:::
:::

::: toc
::: on-this-page
快速导航
:::

::: {.vuepress-toc-item .vuepress-toc-h2 .active}
[定义资源文件](i18n.html#定义资源文件 "定义资源文件")
:::

::: {.vuepress-toc-item .vuepress-toc-h3}
[资源文件命名查找规则及建议](i18n.html#资源文件命名查找规则及建议 "资源文件命名查找规则及建议")
:::

::: {.vuepress-toc-item .vuepress-toc-h3}
[资源文件支持的配置语法](i18n.html#资源文件支持的配置语法 "资源文件支持的配置语法")
:::

::: {.vuepress-toc-item .vuepress-toc-h2}
[页面中引用资源](i18n.html#页面中引用资源 "页面中引用资源")
:::

::: {.vuepress-toc-item .vuepress-toc-h3}
[简单格式化方法](i18n.html#简单格式化方法 "简单格式化方法")
:::

::: {.vuepress-toc-item .vuepress-toc-h3}
[单复数格式化方法](i18n.html#单复数格式化方法 "单复数格式化方法")
:::

::: {.vuepress-toc-item .vuepress-toc-h2}
[获取系统语言](i18n.html#获取系统语言 "获取系统语言")
:::

::: {.vuepress-toc-item .vuepress-toc-h2}
[修改地区语言后的回调](i18n.html#修改地区语言后的回调 "修改地区语言后的回调")
:::
:::
:::

::: global-ui
:::
:::
